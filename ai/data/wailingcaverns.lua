-- face pull wherever possible

t_dungeons[43] = {
	-- Line 1
	{
		{-158.441, 131.601, -74.2552, -1000, 2}, -- 1
		{-120.356, 131.495, -79.4217, -1000, 2}, -- 2
		{-107.619, 178.75, -79.6366, -1000, 2}, -- 3
		{-106.553, 234.974, -91.8383, -1000, 2}, -- 4
		{-76.2306, 218.24, -93.9069, -1000, 2}, -- 5
		{-21.5306, 199.301, -99.1891, -1000, 2}, -- 6
		{-20.8737, 148.296, -106.162, -1000, 2}, -- 7
		{-58.0541, 93.4146, -106.162, -1000, 2}, -- 8
		{-90.3651, 65.1015, -106.162, -1000, 2}, -- 9
		{-135.084, 71.8177, -106.243, -1000, 2}, -- 10
		{-188.479, 39.9326, -105.021, -1000, 2}, -- 11
		{-230.703, 4.45374, -106.714, -1000, 2}, -- 12
		{-282.285, -0.847538, -105.604, -1000, 2}, -- 13
		{-340.454, 33.6526, -99.4382, -1000, 2}, -- 14
		{-318.448, 57.8154, -95.9405, -1000, 2}, -- 15
		{-273.975, 31.2849, -88.221, -1000, 2}, -- 16
		{-217.401, 52.7862, -82.3135, -1000, 2}, -- 17
		{-185.166, 85.2083, -79.476, -1000, 2}, -- 18
		{-168.159, 86.1084, -76.5332, -1000, 2}, -- 19
		{-140.191, 37.8188, -74.9654, -1000, 2}, -- 20
		{-148.705, -14.8873, -77.2796, -1000, 2}, -- 21
		{-175.019, -78.366, -67.6837, -1000, 2}, -- 22
		{-160.415, -98.9694, -66.9214, -1000, 2}, -- 23
		{-117.717, -106.391, -74.5802, -1000, 2}, -- 24
		{-106.982, -109.318, -77.3166, -1000, 2}, -- 25
		{-101.604, -128.218, -79.2318, -1000, 2}, -- 26
		{-43.3006, -162.663, -76.8111, -1000, 2}, -- 27
		{-28.7017, -193.074, -73.9703, -1000, 2}, -- 28
		{5.8868, -226.333, -77.0614, -1000, 2}, -- 29
		{-44.1916, -244.038, -68.6331, -1000, 2}, -- 30
		{-94.1263, -206.282, -69.2583, -1000, 2}, -- 31
		{-94.8461, -191.131, -68.9597, -1000, 2}, -- 32
		{-138.666, -181.004, -68.4351, -1000, 2}, -- 33
		{-153.806, -212.42, -70.3606, -1000, 2}, -- 34
		{-173.596, -214.243, -71.0983, -1000, 2}, -- 35
		{-175.777, -219.408, -71.0277, -1000, 2}, -- 36
		{-188.59, -223.074, -72.4431, -1000, 2}, -- 37
		{-197.58, -251.749, -67.8418, -1000, 2}, -- 38
		{-228.327, -247.551, -63.9476, -1000, 2}, -- 39
		{-237.764, -289.019, -67.831, -1000, 2}, -- 40
		{-266.086, -288.302, -66.6544, -1000, 2}, -- 41
		{-266.344, -266.005, -65.2291, -1000, 2}, -- 42
		{-297.089, -237.392, -64.2013, -1000, 2}, -- 43
		{-281.311, -221.368, -64.2919, -1000, 2}, -- 44
		{-259.252, -200.255, -60.9422, -1000, 2}, -- 45
		{-282.174, -186.631, -61.8093, -1000, 2}, -- 46
		{-307, -135.51, -61.2843, -1000, 2}, -- 47
		{-309.875, -95.2805, -64.568, -1000, 2}, -- 48
		{-329.78, -56.5486, -64.5591, -1000, 2}, -- 49
		{-291.708, -6.01128, -58.6178, -1000, 2}, -- 50
	},
	-- Line 2
	{
		{-285.187, 3.32751, -63.9305, -1000, 2}, -- 1
		{-272.853, 24.4706, -60.0889, -1000, 2}, -- 2
		{-267.922, 50.5975, -54.153, -1000, 2}, -- 3
		{-230.918, 59.3731, -49.6382, -1000, 2}, -- 4
		{-174.841, 57.4604, -42.162, -1000, 2}, -- 5
		{-146.169, 30.8896, -29.1957, -1000, 2}, -- 6
		{-119.077, -27.8236, -29.055, -1000, 2}, -- 7
		{-70.7055, 46.9138, -30.1967, -1000, 2}, -- 8
	},
	-- Line 3
	{
		{-19.8109, 207.853, -99.5103, -1000, 2}, -- 1
		{-12.3588, 244.918, -106.296, -1000, 2}, -- 2
		{-22.1899, 278.941, -106.417, -1000, 2}, -- 3
		{-43.2002, 306.039, -106.417, -1000, 2}, -- 4
		{-74.1671, 325.746, -106.162, -1000, 2}, -- 5
		{-77.5363, 336.783, -106.162, -1000, 2}, -- 6
		{-56.0035, 431.585, -105.716, -1000, 2}, -- 7
		{-10.2441, 467.873, -94.0467, -1000, 2}, -- 8
		{11.3144, 473.792, -88.8062, -1000, 2}, -- 9
		{28.9922, 457.308, -86.2794, -1000, 2}, -- 10
		{31.2503, 433.68, -83.4264, -1000, 2}, -- 11
		{23.1391, 429.68, -81.9042, -1000, 2}, -- 12
		{13.9496, 440.789, -79.9103, -1000, 2}, -- 13
		{6.56031, 454.547, -78.0828, -1000, 2}, -- 14
		{0.298546, 451.436, -75.7892, -1000, 2}, -- 15
		{-2.93021, 420.134, -66.4658, -1000, 2}, -- 16
		{-25.2107, 426.253, -60.5185, -1000, 2}, -- 17
		{-33.496, 380.484, -59.9221, -1000, 2}, -- 18
		{22.1856, 390.94, -59.2547, -1000, 2}, -- 19
		{63.421, 406.027, -63.6772, -1000, 2}, -- 20
		{66.9961, 433.954, -64.2299, -1000, 2}, -- 21
		{42.6434, 480.762, -65.5879, -1000, 2}, -- 22
		{28.4356, 520.775, -57.6282, -1000, 2}, -- 23
		{-35.4152, 481.073, -54.0742, -1000, 2}, -- 24
		{-62.3957, 484.386, -59.5999, -1000, 2}, -- 25
		{-108.416, 450.73, -72.3686, -1000, 2}, -- 26
		{-120.023, 416.954, -72.7514, -1000, 2}, -- 27
		{-156.28, 414.53, -72.6158, -1000, 2}, -- 28
	},
	-- Line 4
	{
		{-34.0019, 222.363, -95.792, -1000, 2}, -- 1
		{-34.0992, 239.431, -93.4996, -1000, 2}, -- 2
		{-55.4262, 291.178, -91.2459, -1000, 2}, -- 3
		{-46.7075, 296.872, -90.7426, -1000, 2}, -- 4
		{-30.638, 314.7, -89.3777, -1000, 2}, -- 5
		{3.72753, 299.959, -86.6408, -1000, 2}, -- 6
		{25.0842, 267.172, -86.7264, -1000, 2}, -- 7
		{31.6276, 249.825, -87.5439, -1000, 2}, -- 8
		{45.5046, 230.496, -87.7924, -1000, 2}, -- 9
		{59.6728, 207.871, -91.5936, -1000, 2}, -- 10
		{74.6939, 208.503, -93.1206, -1000, 2}, -- 11
		{119.575, 269.757, -101.055, -1000, 2}, -- 12
	},
	-- Line 5
	{
		{-39.1589, 190.657, -96.3655, -1000, 2}, -- 1
		{-42.0792, 150.17, -94.0471, -1000, 2}, -- 2
		{-65.678, 124.291, -89.9402, -1000, 2}, -- 3
		{-24.5757, 103.198, -89.6703, -1000, 2}, -- 4
		{-0.896263, 143.021, -89.1114, -1000, 2}, -- 5
		{37.9939, 173.352, -88.4978, -1000, 2}, -- 6
		{47.8275, 193.484, -89.1078, -1000, 2}, -- 7
	},
	-- Line 6
	{
		{-118.087, -89.3224, -71.7596, -1000, 2}, -- 1
		{-102.63, -62.3607, -66.9381, -1000, 2}, -- 2
		{-58.9553, -43.8565, -62.927, -1000, 2}, -- 3
		{-24.7332, -77.304, -67.4072, -1000, 2}, -- 4
		{-41.1017, -119.352, -71.2744, -1000, 2}, -- 5
		{29.9517, -154.069, -79.3114, -1000, 2}, -- 6
		{25.4239, -179.839, -83.7517, -1000, 2}, -- 7
		{-0.90242, -194.989, -80.7336, -1000, 2}, -- 8
	},
	-- Line 7
	{
		{-54.0956, -122.598, -70.0563, -1000, 2}, -- 1
		{-83.4995, -131.114, -65.8189, -1000, 2}, -- 2
		{-111.228, -139.091, -67.5445, -1000, 2}, -- 3
		{-103.379, -162.74, -67.6422, -1000, 2}, -- 4
		{-137.028, -158.425, -67.653, -1000, 2}, -- 5
	},
	-- Line 8
	{
		{-140.922, -227.943, -69.278, -1000, 2}, -- 1
		{-107.202, -264.35, -57.3624, -1000, 2}, -- 2
		{-117.981, -312.985, -62.9889, -1000, 2}, -- 3
		{-150.674, -304.224, -64.2831, -1000, 2}, -- 4
		{-186.631, -350.498, -71.041, -1000, 2}, -- 5
		{-228.812, -307.607, -71.0383, -1000, 2}, -- 6
	},
	-- Line 9
	{
		{-158.765, -289.193, -63.0981, -1000, 2}, -- 1
		{-169.031, -237.155, -56.2303, -1000, 2}, -- 2
		{-181.395, -208.451, -58.2167, -1000, 2}, -- 3
		{-199.946, -189.205, -63.0852, -1000, 2}, -- 4
		{-228.022, -193.141, -61.432, -1000, 2}, -- 5
		{-246.514, -161.529, -63.2088, -1000, 2}, -- 6
		{-263.798, -179.075, -61.0398, -1000, 2}, -- 7
	},
	-- Line 10
	{
		{-146.957, 128.707, -76.5094, -1000, 2}, -- 1
		{-113.026, 145.129, -81.0216, -1000, 2}, -- 2
		{-103.418, 230.946, -90.732, -1000, 2}, -- 3
		{-85.633, 226.403, -93.1301, -1000, 2}, -- 4
		{-64.4188, 207.364, -93.3693, -1000, 2}, -- 5
		{-39.325, 208.459, -96.4432, -1000, 2}, -- 6
	},
	-- Line 11
	{
		{-116.888, -90.9056, -72.3387, -1000, 2}, -- 7
		{-99.7155, -63.6075, -67.7016, -1000, 2}, -- 8
		{-54.739, -50.8602, -63.5143, -1000, 2}, -- 9
		{-23.9873, -79.6825, -67.9792, -1000, 2}, -- 10
		{-53.6092, -121.825, -70.1289, -1000, 2}, -- 11
		{-107.92, -139.217, -67.4467, -1000, 2}, -- 12
		{-108.887, -158.923, -67.4694, -1000, 2}, -- 13
		{-134.968, -162.856, -67.2109, -1000, 2}, -- 14
	},
	-- Line 12
	{
		{-32.9344, -120.539, -71.9445, -1000, 2}, -- 1
		{27.8249, -159.73, -81.128, -1000, 2}, -- 2
		{23.4534, -177.585, -83.3887, -1000, 2}, -- 3
		{10.8592, -195.117, -82.8168, -1000, 2}, -- 4
		{-12.7743, -189.586, -78.1684, -1000, 2}, -- 5
	},
};

local WailingCaverns = t_dungeons[43];

WailingCaverns.trackedunit = {
	{e = 3678, c = 18675}, -- disciple of naralex
};

local _losTbl = Encounter_MakeLOSTbl()
	-- Gully
	.new 'GullyLHSPull' {-39.9750, 228.907, -94.4383} {-41.9783, 211.889, -96.2533}
	.new 'GullyMidPull' {-64.2007, 207.012, -93.4169} {-78.1886, 216.448, -94.2676}
	.new 'GullyRHSPull' {-51.1109, 203.632, -95.7985} {-64.1013, 207.136, -93.4086}
	.new 'GullyFarMidR' {20.61100, 174.182, -86.4906} {-4.30582, 137.582, -89.4311}
	.new 'GullyFarMidL' {38.25170, 233.073, -86.3123} {29.56880, 260.907, -87.5573}
	.new 'GullyFarLHSL' {-28.7733, 319.143, -89.1877} {-42.5544, 319.731, -90.0092}
	.new 'GullyFarLHSR' {27.56630, 213.239, -85.6666} {12.01070, 197.993, -84.4485}
	-- Pit of Fangs
	.new 'PofZigZagHil' {28.106, 436.101, -83.5074} {32.3592, 456.907, -86.0233}
	.new 'PofBigPull__' {30.623, 491.005, -62.9583} {42.2666, 475.067, -65.8934}
.endtbl();

local _areaTbl = Encounter_MakeAreaTbl(_losTbl)
	-- Gully
	.new ('GullyLHSPull', SHAPE_POLYGON) {-30.0701, 245.761} {-43.3259, 305.629} {-87.3256, 284.127} {-65.8363, 238.833} ('GullyLHSPull', -90.00, 6.0)
	.new ('GullyMidPull', SHAPE_POLYGON) {-26.7080, 147.480} {-23.7712, 244.058} {-51.8611, 240.840} {-52.6316, 162.449} ('GullyMidPull', -90.00, 7.0)
	.new ('GullyRHSPull', SHAPE_POLYGON) {-23.1415, 157.096} {-67.8773, 81.1885} {-106.607, 106.449} {-65.2849, 165.782} ('GullyRHSPull', -90.00, 7.0)
	.new ('GullyFarMid_', SHAPE_POLYGON) {74.90000, 256.400} {74.90000, 133.800} {1.130000, 133.800} {1.130000, 256.400} ('GullyFarMidR', -82.00, 12.0)
	.new ('GullyFarLeft', SHAPE_POLYGON) {-25.3866, 338.118} {-0.58024, 253.455} {54.83660, 266.278} {8.506610, 338.140} ('GullyFarLHSL', -82.00, 12.0)
	-- Pit of Fangs
	.new ('PofZigZagHil', SHAPE_POLYGON) {-50.5531, 395.181} {52.9274, 422.305} {17.8387, 484.091} {-33.515, 440.354} ('PofZigZagHil', -82.00, 100.0)
	.new ('PofBigPull__', SHAPE_POLYGON) {-9.83604, 519.452} {22.0180, 489.634} {50.1891, 496.386} {29.1308, 536.267} ('PofBigPull__', -61.00, 50.0)
.endtbl();

local NPC_RANGED_LIST = Encounter_NewRangedList();
function NPC_RANGED_LIST.IsRanged() return true; end

local function TriggerCircle_GullyBridgeLhs(unit, hive, data)
	Print("TriggerCircle_GullyBridgeLhs");
	Encounter_SetAreaLosPos("GullyFarLeft", data.dungeon.AreaTbl, data.dungeon.LosTbl, "GullyFarLHSL");
	Encounter_SetAreaLosPos("GullyFarMid_", data.dungeon.AreaTbl, data.dungeon.LosTbl, "GullyFarMidL");
end

local function TriggerCircle_GullyBridgeRhs(unit, hive, data)
	Print("TriggerCircle_GullyBridgeRhs");
	Encounter_SetAreaLosPos("GullyFarLeft", data.dungeon.AreaTbl, data.dungeon.LosTbl, "GullyFarLHSR");
	Encounter_SetAreaLosPos("GullyFarMid_", data.dungeon.AreaTbl, data.dungeon.LosTbl, "GullyFarMidR");
end

WailingCaverns.triggers = {
	-- Gully
	Encounter_NewTriggerCircle("GullyBridgeLhs", -34.4823,232.442,-94.1785,12,100, TriggerCircle_GullyBridgeLhs),
	Encounter_NewTriggerCircle("GullyBridgeRhs", -44.6570,150.233,-94.1153,12,100, TriggerCircle_GullyBridgeRhs),
};

WailingCaverns.encounters = {
	{name = "Kresh"},
	-- {name = "Lady Anacondra"},
	{name = "Lord Cobrahn"},
	{name = "Lord Pythas"},
	{name = "Skum"},
	{name = "Lord Serpentis"},
	{
		name = "Verdan the Everliving",
		tpos = {-89.742, 26.6626, -31.0772},
		rchrpos = {x=-106.535,y=8.37556,z=-30.2231,melee="ignore"},
		totemPos = {x=-102.939,y=10.5786,z=-30.5405,d=0,a=0},
	},
	{name = "Mutanus the Devourer", tpos = {112.158, 269.794, -99.8681}, rchrpos = {x=96.9593, y=254.332, z=-98.247, melee="ignore"}, sleep = true},
	{
		name               = "Global",
		test               = function() return true; end,
		UseLosBreakForPull = true,
		noboss             = true,
		sleep              = true,
	},
};

WailingCaverns.encounters.LosTbl    = _losTbl;
WailingCaverns.encounters.AreaTbl   = _areaTbl;
WailingCaverns.encounters.RangedTbl = NPC_RANGED_LIST;
